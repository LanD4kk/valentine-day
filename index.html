<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valentine Proposal</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            50: '#fff1f2',
                            100: '#ffe4e6',
                            500: '#f43f5e', // Rose-500
                            600: '#e11d48', // Rose-600
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Import cursive font */
        body {
            font-family: 'Dancing Script', cursive;
        }

        /* Text shadow with dark red */
        .text-shadow-red {
            text-shadow: 3px 3px 6px rgba(139, 0, 0, 0.6);
        }

        /* Floating animation for the image */
        @keyframes float {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-20px);
            }
        }

        .float-animation {
            animation: float 3s ease-in-out infinite;
        }

        /* Smooth transition for the moving button */
        #noBtn {
            transition: all 0.1s ease;
            /* Faster transition makes it feel more "slippery" */
        }

        /* Music Player Controls */
        .music-player {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 0.75rem 1.5rem;
            box-shadow: 0 -2px 20px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .play-pause-btn {
            background: linear-gradient(135deg, #f43f5e, #ec4899);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(244, 63, 94, 0.3);
        }

        .play-pause-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(244, 63, 94, 0.5);
        }

        .play-pause-btn:active {
            transform: scale(0.95);
        }

        .timeline-container {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .timeline {
            flex: 1;
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .timeline-progress {
            height: 100%;
            background: linear-gradient(90deg, #f43f5e, #ec4899);
            border-radius: 3px;
            width: 0%;
            transition: width 0.1s linear;
            position: relative;
        }

        .timeline-progress::after {
            content: '';
            position: absolute;
            right: -6px;
            top: 50%;
            transform: translateY(-50%);
            width: 12px;
            height: 12px;
            background: white;
            border: 2px solid #f43f5e;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .time-display {
            font-size: 0.75rem;
            color: #64748b;
            font-family: monospace;
            min-width: 40px;
        }

        @media (max-width: 640px) {
            .music-player {
                padding: 0.5rem 1rem;
            }

            .play-pause-btn {
                width: 36px;
                height: 36px;
            }

            .time-display {
                font-size: 0.7rem;
            }
        }
    </style>
</head>

<body class="bg-brand-50 flex flex-col h-screen justify-center items-center overflow-hidden select-none">

    <!-- Background Music -->
    <audio id="bgMusic" loop>
        <source src="valentine-song.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <!-- Music Player Controls -->
    <div class="music-player">
        <button id="minimizeBtn" class="minimize-btn" title="Minimize/Expand">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2">
                <polyline points="18 15 12 9 6 15"></polyline>
            </svg>
        </button>

        <button id="playPauseBtn" class="play-pause-btn" title="Play/Pause">
            <svg id="playIcon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                fill="currentColor">
                <path d="M8 5v14l11-7z" />
            </svg>
            <svg id="pauseIcon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                fill="currentColor" style="display: none;">
                <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z" />
            </svg>
        </button>

        <div class="timeline-container">
            <span id="currentTime" class="time-display">0:00</span>
            <div id="timeline" class="timeline">
                <div id="timelineProgress" class="timeline-progress"></div>
            </div>
            <span id="duration" class="time-display">0:00</span>
        </div>
    </div>

    <div class="max-w-sm w-full mx-4 text-center z-10 relative">

        <div id="imageContainer" class="mb-6">
            <img src="cutebear.gif" alt="Cute Bear" class="w-40 h-40 mx-auto object-contain float-animation">
        </div>

        <h1 id="mainTitle" class="text-5xl font-bold mb-4 text-shadow-red" style="color: #8B0000;">Will you be my
            Valentine?</h1>
        <p id="subTitle" class="mb-8 text-2xl text-shadow-red" style="color: #8B0000;">I promise to be a good boyfie
            ever.</p>

        <div class="flex flex-col md:flex-row gap-4 justify-center items-center relative h-12">

            <button id="yesBtn" onclick="acceptProposal()"
                class="bg-brand-500 hover:bg-brand-600 text-white font-bold py-3 px-10 rounded-full transition-transform transform active:scale-95 w-full md:w-auto text-xl"
                style="box-shadow: 0 4px 12px rgba(139, 0, 0, 0.5);">
                Yes, absolutely!
            </button>

            <button id="noBtn"
                class="bg-slate-100 text-slate-700 font-bold py-3 px-10 rounded-full hover:bg-slate-200 w-full md:w-auto md:absolute md:right-[-120px] text-xl"
                style="box-shadow: 0 4px 12px rgba(139, 0, 0, 0.4);">
                No
            </button>
        </div>
    </div>

    <script>
        const noBtn = document.getElementById('noBtn');
        const yesBtn = document.getElementById('yesBtn');
        const mainTitle = document.getElementById('mainTitle');
        const subTitle = document.getElementById('subTitle');
        const imageContainer = document.getElementById('imageContainer');
        const bgMusic = document.getElementById('bgMusic');

        // Attempt to play music on page load
        let musicPlaying = false;

        // Check if music should continue from localStorage
        const musicStarted = localStorage.getItem('valentine_music_started');
        const savedTime = localStorage.getItem('valentine_music_time');

        if (musicStarted === 'true' && savedTime) {
            // Resume from saved position
            bgMusic.currentTime = parseFloat(savedTime);
        }

        // Try to autoplay or resume
        const playPromise = bgMusic.play();

        if (playPromise !== undefined) {
            playPromise.then(() => {
                // Autoplay started successfully
                musicPlaying = true;
                localStorage.setItem('valentine_music_started', 'true');
            }).catch(error => {
                // Autoplay was prevented - will play on user interaction
                console.log('Autoplay prevented, waiting for user interaction');
            });
        }

        // Function to start music on first interaction
        function startMusic() {
            if (!musicPlaying) {
                bgMusic.play().then(() => {
                    musicPlaying = true;
                    localStorage.setItem('valentine_music_started', 'true');
                }).catch(error => {
                    console.log('Failed to play music:', error);
                });
            }
        }

        // Add event listeners to start music on any interaction
        document.addEventListener('click', startMusic, { once: true });
        document.addEventListener('touchstart', startMusic, { once: true });

        // Save current time periodically to localStorage
        bgMusic.addEventListener('timeupdate', () => {
            localStorage.setItem('valentine_music_time', bgMusic.currentTime.toString());
        });

        // Save playing state
        bgMusic.addEventListener('play', () => {
            localStorage.setItem('valentine_music_playing', 'true');
        });

        bgMusic.addEventListener('pause', () => {
            localStorage.setItem('valentine_music_playing', 'false');
        });

        // Music Player Controls
        const playPauseBtn = document.getElementById('playPauseBtn');
        const playIcon = document.getElementById('playIcon');
        const pauseIcon = document.getElementById('pauseIcon');
        const timeline = document.getElementById('timeline');
        const timelineProgress = document.getElementById('timelineProgress');
        const currentTimeDisplay = document.getElementById('currentTime');
        const durationDisplay = document.getElementById('duration');

        // Format time as MM:SS
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // Update play/pause button icon
        function updatePlayPauseIcon() {
            if (bgMusic.paused) {
                playIcon.style.display = 'block';
                pauseIcon.style.display = 'none';
            } else {
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'block';
            }
        }

        // Toggle play/pause
        playPauseBtn.addEventListener('click', () => {
            if (bgMusic.paused) {
                bgMusic.play().then(() => {
                    musicPlaying = true;
                    localStorage.setItem('valentine_music_started', 'true');
                    updatePlayPauseIcon();
                });
            } else {
                bgMusic.pause();
                musicPlaying = false;
                updatePlayPauseIcon();
            }
        });

        // Update timeline as music plays
        bgMusic.addEventListener('timeupdate', () => {
            const progress = (bgMusic.currentTime / bgMusic.duration) * 100;
            timelineProgress.style.width = progress + '%';
            currentTimeDisplay.textContent = formatTime(bgMusic.currentTime);
        });

        // Set duration when metadata loads
        bgMusic.addEventListener('loadedmetadata', () => {
            durationDisplay.textContent = formatTime(bgMusic.duration);
        });

        // Seek functionality
        timeline.addEventListener('click', (e) => {
            const rect = timeline.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const width = rect.width;
            const percentage = clickX / width;
            bgMusic.currentTime = percentage * bgMusic.duration;
        });

        // Update icon on play/pause events
        bgMusic.addEventListener('play', updatePlayPauseIcon);
        bgMusic.addEventListener('pause', updatePlayPauseIcon);

        // Initialize icon state
        updatePlayPauseIcon();

        // Logic to move the "No" button
        function moveButton() {
            // Get viewport dimensions
            const maxWidth = window.innerWidth - noBtn.offsetWidth - 20;
            const maxHeight = window.innerHeight - noBtn.offsetHeight - 20;

            // Generate random coordinates
            const randomX = Math.random() * maxWidth;
            const randomY = Math.random() * maxHeight;

            // Apply new position (using fixed positioning to break out of the flex container)
            noBtn.style.position = 'fixed';
            noBtn.style.left = randomX + 'px';
            noBtn.style.top = randomY + 'px';
        }

        // Event Listeners for "No" Button
        noBtn.addEventListener('mouseover', moveButton); // Desktop
        noBtn.addEventListener('touchstart', (e) => {   // Mobile
            e.preventDefault();
            moveButton();
        });

        // Logic for "Yes" Button
        function acceptProposal() {
            // 1. Trigger Confetti
            confetti({
                particleCount: 150,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#f43f5e', '#ec4899', '#8b5cf6']
            });

            // 2. Change Content
            mainTitle.innerText = "Yeaaay! i know u will say yes";
            subTitle.innerText = "Tekan tombol dibawah ini yaa";

            // Change image to a happy one
            imageContainer.innerHTML = `
                <img src="happybear.gif" 
                     class="w-40 h-40 mx-auto object-contain float-animation">
            `;

            // 3. Hide Buttons
            yesBtn.style.display = 'none';
            noBtn.style.display = 'none';

            // 4. Add navigation button to journey page
            const buttonContainer = document.querySelector('.flex.flex-col.md\\:flex-row');
            buttonContainer.innerHTML = `
                <a href="journey.html" 
                   class="bg-brand-500 hover:bg-brand-600 text-white font-bold py-3 px-10 rounded-full transition-transform transform hover:scale-105 w-full md:w-auto text-xl"
                   style="box-shadow: 0 4px 12px rgba(139, 0, 0, 0.5);">
                    KLIK INI!!!!
                </a>
            `;


            // Optional: Continuous confetti for a few seconds
            const duration = 3000;
            const end = Date.now() + duration;

            (function frame() {
                confetti({
                    particleCount: 3,
                    angle: 60,
                    spread: 55,
                    origin: { x: 0 },
                    colors: ['#f43f5e', '#ec4899']
                });
                confetti({
                    particleCount: 3,
                    angle: 120,
                    spread: 55,
                    origin: { x: 1 },
                    colors: ['#f43f5e', '#ec4899']
                });

                if (Date.now() < end) {
                    requestAnimationFrame(frame);
                }
            }());
        }
    </script>
</body>

</html>